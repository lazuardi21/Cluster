
@{
    ViewBag.Title = "DataVis";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>DataVis</h2>

<!doctype html>
<html>
<head>
    <script src="~/Scripts/d3.v6.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <style>
        svg rect {
            fill: orange;
        }

        svg text {
            fill: white;
            font: 10px sans-serif;
            text-anchor: end;
        }
    </style>
</head>
    <body>
        <svg width="600" height="500"></svg>
        <script>

            var svg = d3.select("svg"),
                margin = 200,
                width = svg.attr("width") - margin,
                height = svg.attr("height") - margin;


            var xScale = d3.scaleBand().range([0, width]).padding(0.4),
                yScale = d3.scaleLinear().range([height, 0]);

            var g = svg.append("g")
                .attr("transform", "translate(" + 100 + "," + 100 + ")");

            var apiBaseUrl = "https://localhost:44375/";

            

            $(function () {
                $.ajax({
                    type: "GET",
                    url: apiBaseUrl + 'api/PL_CUSTOMER_CLUSTER_CENTROID',
                    data: '{}',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: make_graph,
                    failure: function (response) {
                        alert(response.d);
                    },
                    error: function (response) {
                        alert(response.d);
                    }
                });
            });

            function type(d) {
                d.etd = +d.etd;
                d.count = +d.count;
                return d;
            }


            function make_graph(response) {
                console.log(response)
                var myJsonString = JSON.stringify(response);
                var url = apiBaseUrl + 'api/PL_CUSTOMER_CLUSTER_CENTROID';
                d3.xml("https://localhost:44375/api/PL_CUSTOMER_CLUSTER_CENTROID", function (error, data) {
                    if (error) {
                        throw error;
                    }
                    else {
                        console.log(xml.documentElement.getElementsByTagName("ID", ""));
                    }
                    
                    });

                    //type, function (error, data) {
                    //if (error) {
                    //    throw error;
                    //}

                    //xScale.domain(data.map(function (d) { return d.year; }));
                    //yScale.domain([0, d3.max(data, function (d) { return d.value; })]);

                    //g.append("g")
                    //    .attr("transform", "translate(0," + height + ")")
                    //    .call(d3.axisBottom(xScale));

                    //g.append("g")
                    //    .call(d3.axisLeft(yScale).tickFormat(function (d) {
                    //        return "$" + d;
                    //    }).ticks(10))
                    //    .append("text")
                    //    .attr("y", 6)
                    //    .attr("dy", "0.71em")
                    //    .attr("text-anchor", "end")
                    //    .text("value");
                //});

            }
            
        </script>
    </body>
</html>